<!DOCTYPE html>
<html>
<head>
  <title>QR Scanner with Google Sheet</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    #reader { width: 300px; margin: 20px auto; display: none; }
    button { padding: 10px 20px; font-size: 16px; margin-top: 10px; }
    #result { margin-top: 20px; font-size: 18px; color: green; }
  </style>
</head>
<body>
  <h1>QR Code Scanner</h1>
  <button id="startBtn">Start Scan</button>
  <div id="reader"></div>
  <div id="result">Scanned data will appear here</div>

  <script>
    const startBtn = document.getElementById("startBtn");
    const resultElement = document.getElementById("result");
    const readerElement = document.getElementById("reader");
    let html5QrCode;

    const sheetURL = "YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL"; // Replace with your actual URL

    function sendToSheet(id) {
      const payload = {
        id: id,
        data: "Scanned from QR"
      };

      fetch(sheetURL, {
        method: "POST",
        body: JSON.stringify(payload),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(response => response.text())
      .then(result => {
        resultElement.innerText += `\n✅ Saved to Sheet`;
      })
      .catch(error => {
        resultElement.innerText += `\n❌ Error saving to Sheet`;
      });
    }

    startBtn.addEventListener("click", () => {
      readerElement.style.display = "block";
      html5QrCode = new Html5Qrcode("reader");

      Html5Qrcode.getCameras().then(devices => {
        const backCam = devices.find(d => d.label.toLowerCase().includes("back")) || devices[0];

        html5QrCode.start(
          backCam.id,
          { fps: 10, qrbox: 250 },
          decodedText => {
            resultElement.innerText = `Scanned: ${decodedText}`;
            sendToSheet(decodedText);
            html5QrCode.stop();
            readerElement.style.display = "none";
          }
        );
      });
    });
  </script>
</body>
</html>
